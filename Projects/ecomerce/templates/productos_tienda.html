<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda - Ecommerce Store</title>
    <script src="/static/tailwind.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="/static/config.js"></script>
    <script src="/static/ecomerce/productos/productos_tienda.js"></script>
    <style>
        :root {
            --ecommerce-blue: #00bfff;
            --ecommerce-dark: #1a1a1a;
            --ecommerce-gray: #f8f9fa;
            --ecommerce-light: #ffffff;
            --ecommerce-text: #333333;
            --ecommerce-text-light: #666666;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--ecommerce-gray);
            color: var(--ecommerce-text);
            line-height: 1.6;
        }
        .product-card {
            background: var(--ecommerce-light);
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            overflow: hidden;
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }
        .btn-primary {
            background: linear-gradient(135deg, var(--ecommerce-blue) 0%, #0099cc 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 0.75rem 1.5rem;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 191, 255, 0.3);
        }
        .product-card {
            display: flex;
            flex-direction: column;
            height: 100%;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
        }
        .product-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        .product-image-container {
            height: 180px;
            overflow: hidden;
            position: relative;
        }
        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        .product-image:hover {
            transform: scale(1.05);
        }
        .product-info {
            padding: 1rem;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        .product-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--ecommerce-text);
            margin-bottom: 0.5rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.3;
        }
        .product-description {
            color: var(--ecommerce-text-light);
            font-size: 0.8rem;
            margin-bottom: 0.75rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.4;
        }
        .product-price-container {
            margin-bottom: 0.5rem;
        }
        .product-price {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--ecommerce-blue);
        }
        .product-code {
            font-size: 0.7rem;
            color: var(--ecommerce-text-light);
            margin-bottom: 0.75rem;
        }
        .product-variants {
            margin-bottom: 1rem;
        }
        .product-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: auto;
            padding-top: 0.75rem;
            border-top: 1px solid #e5e7eb;
        }
        .product-btn {
            flex: 1;
            padding: 0.6rem 0.8rem;
            border: none;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.4rem;
            text-decoration: none;
            min-height: 40px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .product-image-container {
                height: 140px;
            }
            .product-info {
                padding: 0.8rem;
            }
            .product-title {
                font-size: 1rem;
            }
            .product-description {
                font-size: 0.75rem;
                margin-bottom: 0.5rem;
            }
            .product-price {
                font-size: 1.1rem;
            }
            .product-code {
                font-size: 0.65rem;
                margin-bottom: 0.5rem;
            }
            .product-actions {
                gap: 0.3rem;
                padding-top: 0.5rem;
            }
            .product-btn {
                padding: 0.5rem 0.6rem;
                font-size: 0.75rem;
                min-height: 36px;
            }
        }

        @media (max-width: 480px) {
            .product-image-container {
                height: 120px;
            }
            .product-info {
                padding: 0.6rem;
            }
            .product-title {
                font-size: 0.95rem;
            }
            .product-price {
                font-size: 1rem;
            }
            .product-btn {
                padding: 0.4rem 0.5rem;
                font-size: 0.7rem;
                min-height: 32px;
            }
        }
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--ecommerce-text-light);
        }
        .empty-icon {
            font-size: 4rem;
            color: var(--ecommerce-text-light);
            margin-bottom: 1rem;
        }
        .fade-in {
            animation: fadeIn 0.6s ease-in;
        }
        /* Cart Sidebar */
        .cart-sidebar {
            background: var(--ecommerce-light);
            box-shadow: -4px 0 20px rgba(0, 0, 0, 0.15);
        }
        .cart-overlay {
            background: rgba(0, 0, 0, 0.5);
            -webkit-backdrop-filter: blur(4px);
            backdrop-filter: blur(4px);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-4">
                    <a href="/" class="flex items-center space-x-2 text-gray-800 hover:text-blue-600 transition-colors">
                        <img alt="Logo" class="h-8 w-auto" src="/static/img/logo.png" onerror="this.onerror=null; this.src='/static/img/logo.png'"/>
                        <span class="font-bold text-lg">Tienda Online</span>
                    </a>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="text-gray-600 flex items-center space-x-2">
                        <i class="fas fa-home"></i>
                        <span>Inicio</span>
                    </span>
                    <a href="/ecomerce/productos/tienda" class="text-blue-600 font-semibold flex items-center space-x-2">
                        <i class="fas fa-store"></i>
                        <span>Productos</span>
                    </a>
                    <!-- Usuario no autenticado -->
                    <div id="auth-buttons" class="flex items-center space-x-2">
                        <a href="/ecomerce/login" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2">
                            <i class="fas fa-sign-in-alt"></i>
                            <span>Iniciar Sesión</span>
                        </a>
                        <a href="/ecomerce/register" class="bg-white text-blue-600 border-2 border-blue-600 hover:bg-blue-600 hover:text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2">
                            <i class="fas fa-user-plus"></i>
                            <span>Registrarse</span>
                        </a>
                    </div>
                    <!-- Usuario autenticado -->
                    <div id="user-info" class="flex items-center space-x-2 hidden relative">
                        <div class="relative">
                            <button id="user-dropdown-btn" class="flex items-center space-x-2 text-gray-600 hover:text-blue-600 px-3 py-2 rounded-lg transition-colors">
                                <i class="fas fa-user-circle"></i>
                                <span id="user-greeting">Hola, Usuario</span>
                                <i class="fas fa-chevron-down text-xs"></i>
                            </button>
                            <!-- Dropdown Menu -->
                            <div id="user-dropdown" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-50 hidden">
                                <div class="py-1">
                                    <a href="/ecomerce/perfil" class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors">
                                        <i class="fas fa-heart text-red-500 mr-2"></i>
                                        Mis Favoritos
                                    </a>
                                    <a href="/ecomerce/usuarios/perfil" class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors">
                                        <i class="fas fa-user mr-2"></i>
                                        Mi Perfil
                                    </a>
                                    <div class="border-t border-gray-200"></div>
                                    <button onclick="logout()" class="flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors">
                                        <i class="fas fa-sign-out-alt mr-2"></i>
                                        Salir
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Botón de Favoritos -->
                    <a href="/ecomerce/perfil" class="text-gray-600 hover:text-red-500 px-3 py-2 rounded-lg transition-colors relative hidden" id="wishlist-nav-button" title="Mis Favoritos">
                        <i class="fas fa-heart"></i>
                        <span class="ml-1 hidden md:inline">Favoritos</span>
                        <span class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center hidden" id="wishlist-count">0</span>
                    </a>
                    <button class="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-lg transition-colors relative" id="cart-button" onclick="toggleCart()">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="ml-1 hidden md:inline">Carrito</span>
                        <span class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center" id="cart-count">0</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>
    <!-- Toast Notifications -->
    <div id="toast-container"></div>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="mb-8">
            <h2 class="text-3xl font-bold text-gray-900 mb-4">Nuestra Tienda</h2>
            <p class="text-gray-600">Descubre nuestra amplia selección de productos de calidad</p>
        </div>

        <!-- Filters -->
        <div class="mb-8 bg-white p-6 rounded-lg shadow">
            <div class="flex flex-wrap gap-4 items-center">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Buscar</label>
                    <input type="text" id="search-input" placeholder="Buscar productos..."
                           class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
                    <select id="category-select" class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">Todas las categorías</option>
                    </select>
                </div>
                <button id="search-btn" class="btn-primary">Buscar</button>
            </div>
        </div>

        <!-- Category Description Card -->
        <div id="category-description-card" class="hidden mb-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg shadow-lg overflow-hidden transition-all duration-300">
            <div class="flex flex-col md:flex-row">
                <div id="category-image-container" class="md:w-1/3 h-48 md:h-auto">
                    <img id="category-image" src="" alt="Categoría" class="w-full h-full object-cover">
                </div>
                <div class="flex-1 p-6 text-white">
                    <h2 id="category-title" class="text-3xl font-bold mb-3">Categoría</h2>
                    <p id="category-description" class="text-lg mb-4 opacity-90">Descripción de la categoría</p>
                    <p id="category-product-count" class="text-sm opacity-75">Mostrando productos</p>
                </div>
            </div>
        </div>

        <!-- Record Count -->
        <div class="mb-4 text-gray-600">
            <span id="record-count">Cargando productos...</span>
        </div>

        <!-- Products Grid -->
        <div id="products-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <!-- Products will be loaded here by JavaScript -->
        </div>

        <!-- Loading indicator -->
        <div id="loading" class="text-center py-8">
            <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"></div>
            <p class="mt-2 text-gray-600">Cargando productos...</p>
        </div>

        <!-- No products message -->
        <div id="no-products" class="text-center py-8 hidden">
            <p class="text-gray-600">No se encontraron productos.</p>
        </div>
    </main>

    <!-- Cart Sidebar -->
    <div id="cart-sidebar" class="fixed right-0 top-0 h-full w-96 bg-white shadow-2xl transform translate-x-full transition-transform duration-300 ease-in-out z-50 cart-sidebar">
        <div class="flex flex-col h-full">
            <!-- Cart Header -->
            <div class="flex items-center justify-between p-6 border-b bg-gray-50">
                <h2 class="text-xl font-semibold text-gray-900 flex items-center">
                    <i class="fas fa-shopping-cart mr-2 text-blue-600"></i>
                    Carrito de Compras
                </h2>
                <button onclick="toggleCart()" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <!-- Cart Items -->
            <div id="cart-items" class="flex-1 overflow-y-auto p-6 space-y-4">
                <!-- Cart items will be populated here -->
            </div>

            <!-- Empty Cart Message -->
            <div id="empty-cart" class="hidden flex-1 flex items-center justify-center p-6">
                <div class="text-center">
                    <i class="fas fa-shopping-cart text-gray-300 text-6xl mb-4"></i>
                    <p class="text-gray-500 text-lg">Tu carrito está vacío</p>
                    <p class="text-gray-400 text-sm mt-2">Agrega productos para comenzar</p>
                </div>
            </div>

            <!-- Cart Footer -->
            <div id="cart-footer" class="border-t bg-gray-50 p-6">
                <div class="space-y-4">
                    <div class="flex justify-between items-center text-lg font-semibold">
                        <span>Total:</span>
                        <span id="cart-total" class="text-blue-600">$0.00</span>
                    </div>
                    <button onclick="window.location.href='/ecomerce/checkout'" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg transition-colors font-medium">
                        <i class="fas fa-credit-card mr-2"></i>
                        Proceder al Pago
                    </button>
                    <a href="/ecomerce/carrito" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 py-3 px-4 rounded-lg transition-colors font-medium text-center block">
                        <i class="fas fa-eye mr-2"></i>
                        Ver Carrito Completo
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Overlay -->
    <div id="cart-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden cart-overlay" onclick="toggleCart()"></div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-8 mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <p>&copy; 2025 Tienda Online. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <script>
        // Initialize the tienda page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Tienda page loaded');
            // The productos_tienda.js will handle the product loading
        });
    </script>

    <!-- Scripts de autenticación y carrito -->
    <script src="/static/ecomerce/auth.js"></script>
    <script src="/static/ecomerce/cart_button.js"></script>
    <script src="/static/ecomerce/carrito.js"></script>
    <script src="/static/ecomerce/wishlist_counter.js"></script>
</body>
</html>